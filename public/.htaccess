RewriteEngine On
RewriteCond %{HTTP_HOST} !=localhost  
RewriteCond %{HTTPS} !=on
RewriteRule ^/?(.*) https://%{HTTP_HOST}/$1 [R,L]
Header always set Content-Security-Policy "upgrade-insecure-requests;"

RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)\.html$ http://%{HTTP_HOST}/$1 [R,L]

RewriteRule ^(.*)\.html$ https://%{HTTP_HOST}/$1 [R,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?url=$1
